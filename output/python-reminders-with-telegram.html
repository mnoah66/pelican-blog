<!DOCTYPE html>
<html lang="english" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Reminders with Python, Telegram and Pythonanywhere - Martin Noah</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="./python-reminders-with-telegram.html">

        <meta name="author" content="Martin Noah" />
        <meta name="keywords" content="python,pythonanywhere,telegram" />
        <meta name="description" content="Is today a recycling day? A simple automated way to remind yourself." />

        <meta property="og:site_name" content="Martin Noah" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Reminders with Python, Telegram and Pythonanywhere"/>
        <meta property="og:url" content="./python-reminders-with-telegram.html"/>
        <meta property="og:description" content="Is today a recycling day? A simple automated way to remind yourself."/>
        <meta property="article:published_time" content="2018-10-25" />
            <meta property="article:section" content="Blog" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="pythonanywhere" />
            <meta property="article:tag" content="telegram" />
            <meta property="article:author" content="Martin Noah" />
            <meta property="og:image"
                  content="./images/garbagetwittercard.png"/>

    <meta name="twitter:dnt" content="on">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content=".">
            <meta property="twitter:image"
                  content="./images/garbagetwittercard.png"/>


    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/friendly.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>
        <link href="./static/custom.css" rel="stylesheet">




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
</head>
<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
Martin Noah            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                         <li><a href="./pages/contact.html">
                             Contact
                          </a></li>
                        <li class="active">
                            <a href="./category/blog.html">Blog</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="./archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->



<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./python-reminders-with-telegram.html"
                       rel="bookmark"
                       title="Permalink to Reminders with Python, Telegram and Pythonanywhere">
                        Reminders with Python, Telegram and Pythonanywhere
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-10-25T00:00:00-04:00"> Thu 25 October 2018</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="./tag/python.html">python</a>
        /
	<a href="./tag/pythonanywhere.html">pythonanywhere</a>
        /
	<a href="./tag/telegram.html">telegram</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h2>Is Today a Recyling Day?</h2>
<p>Is what I ask myself every Wednesday morning.  On Wednesday's garbage is collected but every other week it's Garbage <strong>and</strong> Recyling day, but I can never remember and end up having to check the calendar on a website.  So inconvenient, right?!  Let's automate with Python and Telegram.  Telegram is a text messaging service kind of like WhatsApp but it's completely free, and they have an API for things just like this.  Head on over to <a href="https://telegram.org/">Telegram.org</a> for more info.</p>
<p>What we want to accomplish is this: a Telegram bot to text me every Wednesday morning, indicating if it's a recycling and garbage day, or just garbage.  But how do I schedule a task to run every morning? This is a tricky task (sorry,&mdash;I had to) especially for beginners. Enter <a href="https://www.pythonanywhere.com">PythonAnywhere</a>, an incredible source for developing and programming with Python.  It offers full-blown Python environments and website hosting with your own subdomain, and a helpful blog and forum if you're just getting started.  One of it's cool features and a co-subject of this post are scheduled tasks, in which you can write a script to execute at a set time every day.</p>
<p>With the time this has saved me from having to manually check recycling calendars, I'm able to share how I did it with the world! </p>
<h2>Are you ready?</h2>
<p>We'll need the following:</p>
<ol>
<li>A <a href="https://wwww.Pythonanywhere.com">Pythonanywhere.com</a> account - a free account will work.</li>
<li>The Telegram app installed on your phone.</li>
<li>Pictures of garbage/recycling (optional).</li>
</ol>
<h2>Telegram</h2>
<p>Download the telegram app on your smartphone and start a chat with the @BotFather.  Create a new bot with the /newbot command, and the @BotFather will chat with you for the details.  He'll ask you for a general name for your bot and then a unique username. Once finished you'll be given an HTTP API token&mdash;keep that handy as we'll need it later.  </p>
<p><img style="max-width: 400px;width:100%; height:    auto;" src='/images/fatherbot.png'></p>
<p>Back in the main chat menu of Telegram, create a new group.  Tap the search bar, and search for the username of your bot.  What you'll end up with is a "group" chat, but it's only yourself and your bot.  Now we need one additional credential before we can jump into the Python script, and it's the group chat ID. To get the ID, go to <a href="https://web.telegram.org">https://web.telegram.org</a> and follow the steps to get into your account.  Once in, click the group chat you created with your bot.  In the address bar, you'll see a parameter that begins with the letter 'g'.  Take note of this ID.  If you get stuck obtaining the chat ID, <a href="https://stackoverflow.com/questions/32423837/telegram-bot-how-to-get-a-group-chat-id#answer-50661601">see this SO question and answers:</a></p>
<p><img style="max-width: 400px;width:100%; height:    auto;" src='/images/chat_id.png'></p>
<h2>The script</h2>
<p>Let's start by writing the Python script, <strong>garbage.py</strong></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">telegram</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>

<span class="n">bot</span> <span class="o">=</span> <span class="n">telegram</span><span class="o">.</span><span class="n">Bot</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="s1">&#39;YOUR_UNIQUE_TOKEN&#39;</span><span class="p">)</span>
</pre></div>


<p>Import the necessary libraries and create our bot.  Remember to grab your own token that @BotFather gave you.</p>
<div class="highlight"><pre><span></span>recycling_days = [&#39;2018-01-10&#39;, &#39;2018-01-24&#39;, &#39;2018-02-07&#39;,&#39;2018-02-21&#39;, &#39;2018-03-07&#39;, &#39;2018-03-21&#39;,
                &#39;2018-04-07&#39;, &#39;2018-04-18&#39;, &#39;2018-05-02&#39;, &#39;2018-05-16&#39;, &#39;2018-05-30&#39;, &#39;2018-06-13&#39;,
                &#39;2018-06-27&#39;, &#39;2018-07-11&#39;, &#39;2018-07-25&#39;, &#39;2018-08-08&#39;, &#39;2018-08-22&#39;, &#39;2018-09-05&#39;,
                &#39;2018-09-19&#39;, &#39;2018-10-03&#39;, &#39;2018-10-17&#39;, &#39;2018-10-31&#39;, &#39;2018-11-14&#39;, &#39;2018-11-28&#39;,
                &#39;2018-12-12&#39;, &#39;2018-12-26&#39;]
</pre></div>


<p>Create a simple list of strings of the recyling days.</p>
<div class="highlight"><pre><span></span>today = date.today()
</pre></div>


<p>Assign today's date to the variable <code>today</code></p>
<div class="highlight"><pre><span></span>if today.weekday() == 2:
    if str(today) in recycling_days:
        bot.send_photo(chat_id=-&lt;YOUR_CHAT_ID&gt;, photo=open(&#39;garbage_recycling.jpg&#39;, &#39;rb&#39;))
        bot.send_message(chat_id=-&lt;YOUR_CHAT_ID&gt;, text=&quot;Recycling!&quot;)
    else:
        bot.send_photo(chat_id=-&lt;YOUR_CHAT_ID&gt;, photo=open(&#39;garbage.jpeg&#39;, &#39;rb&#39;))
        bot.send_message(chat_id=-&lt;YOUR_CHAT_ID&gt;, text=&quot;Today is just a garbage day.&quot;)
</pre></div>


<p><strong>Note the '-' before your chat id</strong> so an example would be <code>chat_id=-9999233</code></p>
<p>Pythonanywhere's scheduled task feature will run every single day at the time you tell it to run.  For free accounts, you cannot specifiy what day you want it to run, or at what hour.  So we have to decide in our code what day of the week it is, since Garbage/Recycling days are only on Wednesdays (and we don't want to get a Telegram message every day).  We just evaluate if <code>today.weekday() == 2</code> where Monday is the first day of the week starting at 0, Tuesday = 1, Wednesday = 2, and so on.</p>
<p>The rest of the code checks to see if todays date (converted to a string) is in our list of <code>recycling_days</code>.  If it is, we send a photo of recycling cans and a message "Recyling!"  </p>
<p><img style="max-width: 300px;width:100%; height:auto;" src='/images/recycleSmall.jpg'></p>
<p>Otherwise, we send a garbage only image and message.</p>
<p><img style="max-width: 300px;width:100%; height:auto;" src='/images/garbageSmall.jpg'></p>
<h2>Pythonanywhere</h2>
<p>Go to your Pythonanywhere account, navigate to the <strong>Files</strong> tab and upload our file, <strong>garbage.py</strong>, and the images.  Then go to the <strong>Consoles</strong> tab and under "Start a new console:" select <strong>Bash</strong>.</p>
<p>Once the terminal fires up, you'll need to install the Telegram python package.</p>
<p>In the console, type:
<code>pip3.6 install --user python-telegram-bot</code></p>
<p>And, since the default Python version in Pythonanywhere is 2.7, you'll need to add a shebang on the first line of <strong>garbage.py</strong> so that Python 3.6 is used to run the script.</p>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/env python3.6</span>
<span class="kn">import</span> <span class="nn">telegram</span>

<span class="c1"># The rest of the code...</span>
</pre></div>


<h3>Tasks</h3>
<p>Finally, navigate to the <strong>Tasks</strong> tab of our Pythonanywhere account.  Under scheduled tasks, set the UTC time for when you want the script to execute.  I set mine for 10:00 which is 6:00AM NYC time and right around the time my recycling confusion sets in. </p>
<p>In the command text box, enter <code>python 3.6 /home/YOUR_USERNAME/garbage.py</code> and create the task.</p>
<p><img style="max-width: 800px;width:100%; height:    auto;" src='/images/pythonanywhere_task.png'></p>
<p>And now, wait and see if everything worked!</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'martinnoah'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "english";

                        this.page.identifier = '2018-10-25-python-reminders-with-telegram';
                        this.page.url = './python-reminders-with-telegram.html';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://twitter.com/MixMasterMartin"><i class="fab fa-twitter"></i> Twitter</a></li>
    <li class="list-group-item"><a href="https://linkedin.com/in/martin-noah"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
    <li class="list-group-item"><a href="https://www.github.com/mnoah66"><i class="fab fa-github"></i> GitHub</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="./what-do-angle-brackets-mean-to-you.html">What Do Angle Brackets Mean to You?</a></li>
    <li class="list-group-item"><a href="./excel-addin-date-range.html">Addin to Create A Date Range</a></li>
    <li class="list-group-item"><a href="./excel-attendance.html">Tracking Weekly Attendance in Excel with a Custom Function</a></li>
    <li class="list-group-item"><a href="./pandas-excel-attendance.html">Tracking Excel Attendance with Pandas</a></li>
    <li class="list-group-item"><a href="./google-maps-county-border.html">Customizing the Google Maps JavaScript API</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="./tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-3">
      <a href="./tag/blog.html">blog</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/excel.html">excel</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/family.html">family</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/googlemaps.html">googlemaps</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/pandas.html">pandas</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="./tag/python.html">python</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/raspberrypi.html">raspberrypi</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/surveillance.html">surveillance</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2019 Martin Noah
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>                <p><small>  <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.english"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.english">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>

<!-- Google Recaptcha -->
<script src='https://www.google.com/recaptcha/api.js'></script>



<!--
    <script src="./theme/js/bodypadding.js"></script>
-->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'martinnoah'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-118771828-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b01709f0c3abefa"></script>


</body>
</html>