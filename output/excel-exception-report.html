<!DOCTYPE html>
<html lang="english" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Exception Reports with Excel - Martin Noah</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="./excel-exception-report.html">

        <meta name="author" content="Martin Noah" />
        <meta name="keywords" content="Excel,vba,automation" />
        <meta name="description" content="The filter option in Excel spreadsheets provides for an incredibly easy way to find and sort your data. But there are times when it can get a bit clunky, especially if you have a large range of different values, and you or your users are not comfortable with or familiar …" />

        <meta property="og:site_name" content="Martin Noah" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Exception Reports with Excel"/>
        <meta property="og:url" content="./excel-exception-report.html"/>
        <meta property="og:description" content="The filter option in Excel spreadsheets provides for an incredibly easy way to find and sort your data. But there are times when it can get a bit clunky, especially if you have a large range of different values, and you or your users are not comfortable with or familiar …"/>
        <meta property="article:published_time" content="2018-05-27" />
            <meta property="article:section" content="Blog" />
            <meta property="article:tag" content="Excel" />
            <meta property="article:tag" content="vba" />
            <meta property="article:tag" content="automation" />
            <meta property="article:author" content="Martin Noah" />
            <meta property="og:image"
                  content="./images/excelOG.png"/>

    <meta name="twitter:dnt" content="on">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content=".">
            <meta property="twitter:image"
                  content="./images/excelOG.png"/>


    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>




    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src='https://www.google.com/recaptcha/api.js'></script>
</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
Martin Noah            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                         <li><a href="./pages/contact.html">
                             Contact
                          </a></li>
                        <li class="active">
                            <a href="./category/blog.html">Blog</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./excel-exception-report.html"
                       rel="bookmark"
                       title="Permalink to Exception Reports with Excel">
                        Exception Reports with Excel
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-05-27T00:00:00-04:00"> Sun 27 May 2018</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="./tag/excel.html">Excel</a>
        /
	<a href="./tag/vba.html">vba</a>
        /
	<a href="./tag/automation.html">automation</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>The filter option in Excel spreadsheets provides for an incredibly easy way to find and sort your data.  But there are times when it can get a bit clunky, especially if you have a large range of different values, and you or your users are not comfortable with or familiar with all of the ways in which the data can be filtered.  And what if your users want nothing to do with Excel but it's a requirement of their job to use it? This is where Visual Basic for Applications (VBA) comes in handy.  With the simple click of a button (who can't do that?!), users can be presented with the data they need without having to dive (shallow or deeply) into any of Excel's robust features.</p>
<p>In this post, we're going to mimic the submission of invoice-type data in a corporate setting, but only after the salesperson has entered an explanation for any exceptions we identify.  So let's say that you want a salesperson to only be able to submit his invoice report to the accounts receivable department only <em>after</em> he/she has added an explanation for each invoice less than $100.00.  Perhaps there was a sale that week, a smaller order from the purchaser, or a discount was applied to the order.  VBA allows for complex operations to be completed very simply with the use of Macros, functions, and the like.</p>
<p>Open up an Excel spreadsheet and get some data in columns A and B like so:</p>
<p><img style="max-width: 400px;width:100%; height:  auto;" src='/images/amount_explanation.png'></p>
<p>Then, go to the Developer tab and click the Insert option. Under ActiveX controls, select the icon to add a Command Button.</p>
<p><img style="max-width: 400px;width:100%; height:  auto;" src='/images/commandButton.png'></p>
<p>Draw the Command Button next to your data columns.  Your spreadsheet will now change to Design Mode.  Right click on the newly place command button, then hover over 'CommandButton Object' then click Edit to modify the label of the button.  I changed mine to "Submit" because eventually this will be used to email the entire workbook.</p>
<p><img style="max-width: 400px;width:100%; height:  auto;" src='/images/submitbutton.png'></p>
<p>Finally, right-click on the button and select 'View Code.'  Copy and paste the below lines of code inbetween the 'Private Sub CommandButton1_Click()' and 'End Sub' lines.</p>
<div class="highlight"><pre><span></span>Dim sht As Worksheet
Dim indicator As Boolean

Set sht = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)
indicator = True
lastrow = sht.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row

    &#39; Start at the second row, go until the last row that contains data
    For x = 2 To lastrow 
        &#39; If the amount value is less than $100.00 AND there is no explanation
        &#39; Turn the exaplanation cell red as a visual indicator and change the indicator variable to false
        If sht.Cells(x, 1).Value &lt; 100 And sht.Cells(x, 2).Value = &quot;&quot; Then
            sht.Cells(x, 2).Interior.ColorIndex = 22
            indicator = False
        End If
    Next x

    &#39; If any of the cells are &lt; $100 and there is no comment, prompt the user to enter an explanation.
    If indicator = False Then
        MsgBox &quot;One or more explanations is required before submission&quot;
    Else
        &#39; Submit to ....
        MsgBox &quot;SUCCESS! Submitted to A/R!&quot;
    End If
</pre></div>


<p>Finally, we are ready to click that button.  But first, make sure that your spreadsheet is not still in design mode by goign to the Developer tab and clicking Design Mode if it is currently selected.</p>
<p>The program cycles through all values in column A.  If it finds a value less than $100.00 and no explanation in the cell next to it, it highlights the 'Explanation' cell, prompting the user to add an explanation, and changes the 'indicator' value to <code>False</code>.  You could do this using a While (true) loop but the loop'll break after finding the first exception, only highlighting the first instance of a cell &lt; $100.00.  Instead, we loop through all of the data, highlight all of the exceptions, and evaluate the indicator variable at the end of the program.  If there is an explanation for each value under $100, the indicator value remains <code>True</code> and the user is prompted with a 'Success' message box.</p>
<p><img style="max-width: 640px;width:100%; height:  auto;" src='/images/output.gif'></p>
<p>You can then extend the existing project to email the entire workbook using <a href="https://www.rondebruin.nl/win/s1/outlook/amail1.htm">Ron de Bruin's Excel Automation Tips</a>. A little bit of work on your part can significantly improve automation and efficiency in your environment, and allow your staff or volunteers to focus on what's important.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'martinnoah'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "english";

                        this.page.identifier = '2018-05-27-excel-exception-report';
                        this.page.url = './excel-exception-report.html';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<div id="aboutme">
    <p>
      <strong>About Martin Noah</strong><br/>
        Random tutorials and blog posts about Python, Excel, Web Development, and maybe some hockey (Go Pens!)
    </p>
</div><!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://twitter.com/MixMasterMartin"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
    <li class="list-group-item"><a href="https://www.facebook.com/martin.noah.98"><i class="fa fa-facebook-square fa-lg"></i> Facebook</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="./"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group " id="tags">
    <li class="list-group-item tag-0">
      <a href="./tag/python.html">python</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/blog.html">blog</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/raspberrypi.html">raspberrypi</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/googlemaps.html">googlemaps</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/ffmpeg.html">ffmpeg</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/windows.html">windows</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/pandas.html">pandas</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/twilio.html">Twilio</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/telegram.html">telegram</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/excel.html">Excel</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/automation.html">automation</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/vba.html">vba</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/pelican.html">pelican</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/dataframe.html">dataframe</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/pythonanywhere.html">pythonanywhere</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/ngrok.html">ngrok</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/timelapse.html">timelapse</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/surveillance.html">surveillance</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Martin Noah
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>


    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'martinnoah'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-118771828-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b01709f0c3abefa"></script>
</body>
</html>