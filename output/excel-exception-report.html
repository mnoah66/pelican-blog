<!DOCTYPE html>
<html lang="english" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Exception Reports with Excel - Martin Noah</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="./excel-exception-report.html">

        <meta name="author" content="Martin Noah" />
        <meta name="keywords" content="Excel,vba,automation" />
        <meta name="description" content="The filter option in Excel spreadsheets provides for an incredibly easy way to find and sort your data. But there are times when it can get a bit clunky, especially if you have a large range of different values, and you or your users are not comfortable with or familiar …" />

        <meta property="og:site_name" content="Martin Noah" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Exception Reports with Excel"/>
        <meta property="og:url" content="./excel-exception-report.html"/>
        <meta property="og:description" content="The filter option in Excel spreadsheets provides for an incredibly easy way to find and sort your data. But there are times when it can get a bit clunky, especially if you have a large range of different values, and you or your users are not comfortable with or familiar …"/>
        <meta property="article:published_time" content="2018-05-27" />
            <meta property="article:section" content="Blog" />
            <meta property="article:tag" content="Excel" />
            <meta property="article:tag" content="vba" />
            <meta property="article:tag" content="automation" />
            <meta property="article:author" content="Martin Noah" />
            <meta property="og:image"
                  content="./images/excelOG.png"/>

    <meta name="twitter:dnt" content="on">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content=".">
            <meta property="twitter:image"
                  content="./images/excelOG.png"/>


    <!-- Bootstrap -->
        <link rel="stylesheet" href="./theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="./theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="./theme/css/pygments/friendly.css" rel="stylesheet">
    <link rel="stylesheet" href="./theme/css/style.css" type="text/css"/>
        <link href="./static/custom.css" rel="stylesheet">




    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    
</head>
<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="./" class="navbar-brand">
Martin Noah            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="./pages/about.html">
                             About
                          </a></li>
                         <li><a href="./pages/contact.html">
                             Contact
                          </a></li>
                        <li class="active">
                            <a href="./category/blog.html">Blog</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="./archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->



<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="./excel-exception-report.html"
                       rel="bookmark"
                       title="Permalink to Exception Reports with Excel">
                        Exception Reports with Excel
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-05-27T00:00:00-04:00"> Sun 27 May 2018</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="./tag/excel.html">Excel</a>
        /
	<a href="./tag/vba.html">vba</a>
        /
	<a href="./tag/automation.html">automation</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>The filter option in Excel spreadsheets provides for an incredibly easy way to find and sort your data.  But there are times when it can get a bit clunky, especially if you have a large range of different values, and you or your users are not comfortable with or familiar with all of the ways in which the data can be filtered.  And what if your users want nothing to do with Excel but it's a requirement of their job to use it? This is where Visual Basic for Applications (VBA) comes in handy.  With the simple click of a button (who can't do that?!), users can be presented with the data they need without having to dive (shallow or deeply) into any of Excel's robust features.</p>
<p>In this post, we're going to mimic the submission of invoice-type data in a corporate setting, but only after the salesperson has entered an explanation for any exceptions we identify.  So let's say that you want a salesperson to only be able to submit his invoice report to the accounts receivable department only <em>after</em> he/she has added an explanation for each invoice less than $100.00.  Perhaps there was a sale that week, a smaller order from the purchaser, or a discount was applied to the order.  VBA allows for complex operations to be completed very simply with the use of Macros, functions, and the like.</p>
<p>Open up an Excel spreadsheet and get some data in columns A and B like so:</p>
<p><img style="max-width: 400px;width:100%; height:  auto;" src='/images/amount_explanation.png'></p>
<p>Then, go to the Developer tab and click the Insert option. Under ActiveX controls, select the icon to add a Command Button.</p>
<p><img style="max-width: 400px;width:100%; height:  auto;" src='/images/commandButton.png'></p>
<p>Draw the Command Button next to your data columns.  Your spreadsheet will now change to Design Mode.  Right click on the newly place command button, then hover over 'CommandButton Object' then click Edit to modify the label of the button.  I changed mine to "Submit" because eventually this will be used to email the entire workbook.</p>
<p><img style="max-width: 400px;width:100%; height:  auto;" src='/images/submitbutton.png'></p>
<p>Finally, right-click on the button and select 'View Code.'  Copy and paste the below lines of code inbetween the 'Private Sub CommandButton1_Click()' and 'End Sub' lines.</p>
<div class="highlight"><pre><span></span><span class="n">Dim</span> <span class="n">sht</span> <span class="n">As</span> <span class="n">Worksheet</span>
<span class="n">Dim</span> <span class="n">indicator</span> <span class="n">As</span> <span class="n">Boolean</span>

<span class="n">Set</span> <span class="n">sht</span> <span class="o">=</span> <span class="n">ThisWorkbook</span><span class="o">.</span><span class="n">Worksheets</span><span class="p">(</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
<span class="n">indicator</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">lastrow</span> <span class="o">=</span> <span class="n">sht</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">Rows</span><span class="o">.</span><span class="n">Count</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">End</span><span class="p">(</span><span class="n">xlUp</span><span class="p">)</span><span class="o">.</span><span class="n">Row</span>

    <span class="s1">&#39; Start at the second row, go until the last row that contains data</span>
    <span class="n">For</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span> <span class="n">To</span> <span class="n">lastrow</span> 
        <span class="s1">&#39; If the amount value is less than $100.00 AND there is no explanation</span>
        <span class="s1">&#39; Turn the exaplanation cell red as a visual indicator and change the indicator variable to false</span>
        <span class="n">If</span> <span class="n">sht</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">&lt;</span> <span class="mi">100</span> <span class="n">And</span> <span class="n">sht</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">Value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="n">Then</span>
            <span class="n">sht</span><span class="o">.</span><span class="n">Cells</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">Interior</span><span class="o">.</span><span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">22</span>
            <span class="n">indicator</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">End</span> <span class="n">If</span>
    <span class="n">Next</span> <span class="n">x</span>

    <span class="s1">&#39; If any of the cells are &lt; $100 and there is no comment, prompt the user to enter an explanation.</span>
    <span class="n">If</span> <span class="n">indicator</span> <span class="o">=</span> <span class="bp">False</span> <span class="n">Then</span>
        <span class="n">MsgBox</span> <span class="s2">&quot;One or more explanations is required before submission&quot;</span>
    <span class="n">Else</span>
        <span class="s1">&#39; Submit to ....</span>
        <span class="n">MsgBox</span> <span class="s2">&quot;SUCCESS! Submitted to A/R!&quot;</span>
    <span class="n">End</span> <span class="n">If</span>
</pre></div>


<p>Finally, we are ready to click that button.  But first, make sure that your spreadsheet is not still in design mode by goign to the Developer tab and clicking Design Mode if it is currently selected.</p>
<p>The program cycles through all values in column A.  If it finds a value less than $100.00 and no explanation in the cell next to it, it highlights the 'Explanation' cell, prompting the user to add an explanation, and changes the 'indicator' value to <code>False</code>.  You could do this using a While (true) loop but the loop'll break after finding the first exception, only highlighting the first instance of a cell &lt; $100.00.  Instead, we loop through all of the data, highlight all of the exceptions, and evaluate the indicator variable at the end of the program.  If there is an explanation for each value under $100, the indicator value remains <code>True</code> and the user is prompted with a 'Success' message box.</p>
<p><img style="max-width: 640px;width:100%; height:  auto;" src='/images/output.gif'></p>
<p>You can then extend the existing project to email the entire workbook using <a href="https://www.rondebruin.nl/win/s1/outlook/amail1.htm">Ron de Bruin's Excel Automation Tips</a>. A little bit of work on your part can significantly improve automation and efficiency in your environment, and allow your staff or volunteers to focus on what's important.</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <!-- AddThis Button BEGIN -->
    <div class="addthis_toolbox addthis_default_style">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
            <a class="addthis_button_tweet"></a>
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    </div>
    <!-- AddThis Button END -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'martinnoah'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "english";

                        this.page.identifier = '2018-05-27-excel-exception-report';
                        this.page.url = './excel-exception-report.html';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://twitter.com/MixMasterMartin"><i class="fab fa-twitter"></i> Twitter</a></li>
    <li class="list-group-item"><a href="https://linkedin.com/in/martin-noah"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
    <li class="list-group-item"><a href="https://www.github.com/mnoah66"><i class="fab fa-github"></i> GitHub</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="./what-do-angle-brackets-mean-to-you.html">What Do Angle Brackets Mean to You?</a></li>
    <li class="list-group-item"><a href="./excel-addin-date-range.html">Addin to Create A Date Range</a></li>
    <li class="list-group-item"><a href="./excel-attendance.html">Tracking Weekly Attendance in Excel with a Custom Function</a></li>
    <li class="list-group-item"><a href="./pandas-excel-attendance.html">Tracking Excel Attendance with Pandas</a></li>
    <li class="list-group-item"><a href="./google-maps-county-border.html">Customizing the Google Maps JavaScript API</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Tag Cloud -->
<li class="list-group-item">
  <a href="./tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
  <ul class="list-group list-inline tagcloud" id="tags">
    <li class="list-group-item tag-3">
      <a href="./tag/blog.html">blog</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/excel.html">excel</a>
    </li>
    <li class="list-group-item tag-4">
      <a href="./tag/family.html">family</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/googlemaps.html">googlemaps</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/pandas.html">pandas</a>
    </li>
    <li class="list-group-item tag-1">
      <a href="./tag/python.html">python</a>
    </li>
    <li class="list-group-item tag-2">
      <a href="./tag/raspberrypi.html">raspberrypi</a>
    </li>
    <li class="list-group-item tag-3">
      <a href="./tag/surveillance.html">surveillance</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Tag Cloud -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2019 Martin Noah
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>                <p><small>  <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.english"><img alt="Creative Commons License" style="border-width:0" src="//i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    Content
  licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.english">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>, except where indicated otherwise.
</small></p>
         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="./theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="./theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="./theme/js/respond.min.js"></script>

<!-- Google Recaptcha -->
<script src='https://www.google.com/recaptcha/api.js'></script>



<!--
    <script src="./theme/js/bodypadding.js"></script>
-->
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'martinnoah'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-118771828-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->


        <script type="text/javascript">var addthis_config = {"data_track_addressbar": true};</script>
    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b01709f0c3abefa"></script>


</body>
</html>